mashupApp.controller("mashup.LoginController",["$location","$log","$timeout","$scope","sessionService","cacheService","utility",function(a,b,c,d,e,f,g){"use strict";var h=this;h.appName="coreSession";var i=function(){return f.getCache("mashupSessions")};i().then(function(a){h.appSession=a[0],("NoCache"===h.appSession||"N"===h.appSession||_.isNull(h.appSession)||_.isUndefined(h.appSession))&&(h.appSession={sessions:[]},h.appSession.id="mashupSessions");var b=_.findIndex(h.appSession.sessions,{appName:h.appName});b>-1&&(h.labelUserName=h.appSession.sessions[b].userName)}),h.login=function(){var b=!0;b?(k(h.name,h.appName),j(h.name,h.appName),m(h.name,h.appName,b),a.path("/")):m(h.name,h.appName,b)};var j=function(a,b){var c=e.getUserSessions();c.userName=a,c.appName=b,e.setUserSession(c)},k=function(a,b){var c;c=!!_.where(h.appSession.sessions,{appName:b}).length;var d=l(a,b);if(c){var e=_.findIndex(h.appSession.sessions,{appName:b});h.appSession.sessions[e]=d}else h.appSession.sessions.push(d);f.putCache("mashupSessions",{name:"mashupSessions",keyPath:"id"},h.appSession)},l=function(a,b){var c={},d=g.localMilToUtcMil((new Date).getTime()),e=g.utcMilToLocalMil(d),f=Date(e),h=["DomainUser","MashupUser","Administrator"];return c.appName=b,c.userName=a,c.roles=h,c.authTimeUTCMills=d,c.authTimelocalMills=e,c.authTimelocalDate=f,c.sessionLastUsed=d,c.isAuthenticated=!0,c},m=function(a,c,d){var f=g.getLogObject("Instr",c,"mashup.LoginController","login",d,e);f.userName=a,f.appName=c,f.authenticated=d,b.log("Authentication [ User: "+a+" ] on [App: "+c+" ]",f)}}]);
//# sourceMappingURL=login.controller.min.js.map