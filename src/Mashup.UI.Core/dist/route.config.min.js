mashupApp.factory("coreRouteHelper",["$log","$q","$location","sessionService","utility",function(a,b,c,d,e){"use strict";var f=function(b){var f=e.getLogObject("Instr",b,"coreRouteHelper","logRoute","resolving route",d);f.absUrl=c.absUrl(),f.url=c.url(),a.log("UI-Routing to [ "+c.url()+" ]",f)},g=function(a){var c=b.defer();return function(){f(a),c.resolve(!0)}(),c.promise};return{logRoute:g}}]),mashupApp.config(["$routeProvider",function(a){"use strict";a.when("/app1/page1",{templateUrl:"apps/app1/page1/page1.html",controller:"app1.Page1Controller",controllerAs:"vm",resolve:{loadMyCtrl:["$ocLazyLoad",function(a){return a.load({name:"mashupApp",files:["apps/app1/page1/page1.controller.min.js"]})}],logRoute:["$route","coreRouteHelper",function(a,b){return b.logRoute()}]}}).when("/app1/page2",{templateUrl:"apps/app1/page2/page2.html",controller:"app1.Page2Controller",controllerAs:"vm",resolve:{loadMyCtrl:["$ocLazyLoad",function(a){return a.load({name:"mashupApp",files:["apps/app1/page2/page2.controller.min.js"]})}],logRoute:["$route","coreRouteHelper",function(a,b){return b.logRoute()}]}})}]),mashupApp.config(["$routeProvider",function(a){"use strict";a.when("/app2/page3",{templateUrl:"apps/app2/page3/page3.html",controller:"app2.Page3Controller",controllerAs:"vm",resolve:{loadMyCtrl:["$ocLazyLoad",function(a){return a.load({name:"mashupApp",files:["apps/app2/page3/page3.controller.min.js"]})}],logRoute:["$route","coreRouteHelper",function(a,b){return b.logRoute()}]}}).when("/app2/page4",{templateUrl:"apps/app2/page4/page4.html",controller:"app2.Page4Controller",controllerAs:"vm",resolve:{loadMyCtrl:["$ocLazyLoad",function(a){return a.load({name:"mashupApp",files:["apps/app2/page4/page4.controller.min.js"]})}],logRoute:["$route","coreRouteHelper",function(a,b){return b.logRoute()}]}})}]),mashupApp.config(["$routeProvider",function(a){a.otherwise({redirectTo:"/mashup"}),a.when("/mashup/about",{templateUrl:"apps/mashup/about.html",controller:"mashup.AboutController",controllerAs:"vm",resolve:{loadMyCtrl:["$ocLazyLoad",function(a){return a.load({name:"mashupApp",files:["apps/mashup/about.controller.min.js"]})}],resolveRoute:["$route","mashupRouterAuth",function(a,b){return b.resolveRoute(["Administrator"])}]}}).when("/mashup",{templateUrl:"apps/mashup/welcome.html",controller:"mashup.WelcomeController",controllerAs:"vm",resolve:{loadMyCtrl:["$ocLazyLoad",function(a){return a.load({name:"mashupApp",files:["apps/mashup/welcome.controller.min.js"]})}],resolveRoute:["$route","mashupRouterAuth",function(a,b){return b.resolveRoute(["MashupUser"])}]}}).when("/mashup/login",{templateUrl:"apps/mashup/login.html",controller:"mashup.LoginController",controllerAs:"vm",resolve:{loadMyCtrl:["$ocLazyLoad",function(a){return a.load({name:"mashupApp",files:["apps/mashup/login.controller.min.js"]})}],logRoute:["$route","coreRouteHelper",function(a,b){return b.logRoute("mashup")}]}})}]),mashupApp.factory("mashupRouterAuth",["$log","$q","$timeout","$location","$interval","sessionService","cacheService","utility","coreRouteHelper",function(a,b,c,d,e,f,g,h,i){"use strict";var j=function(a){var c=b.defer();return function(){k().then(function(b){var e=b[0],f=_.first(_.where(e.sessions,{appName:"coreSession"})),g=l(f),j=m(f,a);g?f.sessionLastUsed=h.localMilToUtcMil((new Date).getTime()):(d.path("/mashup/login"),j||c.reject()),i.logRoute("mashup"),c.resolve(!0)})}(),c.promise},k=function(){return g.getCache("mashupSessions")},l=function(a){if(_.isNull(a)||_.isUndefined(a))return!1;var b=(a.userName,a.isAuthenticated),c=(a.authDateTime,a.authTimeUTCMills),d=!0;b||(d=!1);var e=h.localMilToUtcMil((new Date).getTime()),f=60,g=c+6e4*f;return e>g&&(d=!1),d},m=function(a,b){var c=!1;return 0===b.length&&(c=!0),_.isNull(a)?c=!1:angular.isArray(b)&&angular.forEach(b,function(b,d){_.contains(a.roles,b)&&(c=!0)}),c};return{resolveRoute:j}}]);
//# sourceMappingURL=route.config.min.js.map